databaseChangeLog:
  - changeSet:
      id: 005-raw-manual-prices
      author: you
      changes:
        - createTable:
            tableName: raw_material_manual_price
            columns:
              - column: { name: id, type: uuid, constraints: { primaryKey: true, nullable: false } }
              - column: { name: raw_material_id, type: uuid, constraints: { nullable: false } }
              - column: { name: price_per_gram, type: numeric(14,6), constraints: { nullable: false } }
              - column: { name: currency, type: varchar(8), constraints: { nullable: false } }
              - column: { name: valid_from, type: date, constraints: { nullable: false } }
              - column: { name: valid_to, type: date }
              - column: { name: created_at, type: timestamptz, constraints: { nullable: false } }

        - addForeignKeyConstraint:
            baseTableName: raw_material_manual_price
            baseColumnNames: raw_material_id
            referencedTableName: raw_material
            referencedColumnNames: id
            constraintName: fk_manual_price_raw

        - createIndex:
            tableName: raw_material_manual_price
            indexName: ix_manual_price_raw_validfrom
            columns:
              - column: { name: raw_material_id }
              - column: { name: valid_from }
